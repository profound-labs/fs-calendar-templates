\ProvidesPackage{wall-local}

\input{../calendar-shared.tex}

% NOTE: loading custom helpers.lua for two-page size tweaking
\luadirect{
require("./helpers.lua")
setDateTexts(tonumber(\CalendarYear), \luastring{\@wall@eventsCsv})
}

\definecolor{gridcolor}{gray}{0.85}
\colorlet{mooncolor}{darkgold}
\colorlet{sunday}{black}

\renewcommand*\quoteRef[1]{\itshape\fontsize{12}{16}\selectfont #1}

\renewcommand{\FrontmatterFmt}{%
  \fontsize{9}{14}\selectfont%
  \setlength{\parskip}{0.5\baselineskip}%
  \vspace*{-4\baselineskip}%
}

\renewcommand{\calendarMarks}{%
  \parseMonthMarksDayTextAsCornerMarks%
  \parseMonthMarksNote%
}

\renewcommand\photoAndNotesFmt{%
  \renewcommand\notepadContent{}%
  \renewcommand*\monthFmt{\fontsize{24}{24}\selectfont\color{darkgold}\ShakerLightFont}%
  \renewcommand*\yearFmt{\fontsize{24}{24}\selectfont\color{darkgold}\ShakerLightFont}%
  \renewcommand*\dayLetterColor{}%
  \renewcommand*\dayLetterFmt{\small}%
  \renewcommand*\dayLetterTextFmt[1]{\tiny\textls*{\MakeUppercase{##1}}}%
  \renewcommand*\dayTextFmt{\small\ShakerRegularFont}%
  \renewcommand*\quoteFmt{\centering\ShakerLightFont\fontsize{15}{20}\selectfont}%
  \renewcommand*\headingFmt{\centering}%
  \renewcommand*\calendarFmt{\centering}%
  \renewcommand*\eventsFmt{\setlength{\parindent}{0pt}\raggedright\fontsize{10}{12}\selectfont}%
  \setlength{\@t@calendar@minimumHeight}{\calPaperHeight - 30mm}%
  \setlength{\@t@calendar@hmargin}{20pt}%
  % white space to allow:
  % - month and year label
  % - notepad area
  % - extra white space
  \setlength{\@t@calendar@verticalSpacing}{30mm}%
}

\pgfkeys{
  /put photo/.is family, /put photo,
  portrait/.code = {%
    \def\@wall@photo@putPhoto##1{%
      \begin{minipage}[t][\calPaperHeight][b]{\calPaperWidth}%
        \centering
        \mbox{}\vfill
        
        \includegraphics[width=0.5\linewidth]{##1}%

        \vfill\mbox{}%
      \end{minipage}%
    }%
    \def\@wall@photo@setYOffset{}%
  },
}

% === Year Planner ===

\renewcommand\preYearPlannerPageHook{%
  \renewcommand\monthMarkFmt{\fontsize{6}{6}\selectfont\color{textbody}}%
  \renewcommand\symbolSeparator{,}%
  \setlength{\markNumberAbove}{-7pt}%
  \setlength{\markNumberRight}{-6pt}%
  \setlength{\markDayTextAbove}{-9pt}%
  \setlength{\markDayTextRight}{-6pt}%
}

\setlength{\plannerNotesSep}{8mm}
\setlength{\plannerTitleSep}{7mm}
\setlength{\plannerTopSkip}{-\baselineskip}

% =============================== Quote positions ==============================

% The Portuguese translation has more lines in some cases
\ifthenelse{\equal{\@wall@calendarLanguage}{portuguese}}{
\SetQuote[xOffset=0pt, yOffset=-15mm]{January}{\txt{January Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{February}{\txt{February Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{March}{\txt{March Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{April}{\txt{April Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{May}{\txt{May Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{June}{\txt{June Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{July}{\txt{July Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{August}{\txt{August Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{September}{\txt{September Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{October}{\txt{October Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{November}{\txt{November Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{December}{\txt{December Quote}}
}{
\SetQuote[xOffset=-12mm, yOffset=0pt]{January}{\txt{January Quote}}
\SetQuote[xOffset=-12mm, yOffset=0pt]{February}{\txt{February Quote}}
\SetQuote[xOffset=-12mm, yOffset=-108mm]{March}{\txt{March Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{April}{\txt{April Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{May}{\txt{May Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{June}{\txt{June Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{July}{\txt{July Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{August}{\txt{August Quote}}
\SetQuote[xOffset=-12mm, yOffset=0pt]{September}{\txt{September Quote}}
\SetQuote[xOffset=0pt, yOffset=-15mm]{October}{\txt{October Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{November}{\txt{November Quote}}
\SetQuote[xOffset=0pt, yOffset=-20mm]{December}{\txt{December Quote}}
}

% =============================== January ======================================

\SetPhoto[bleed=3mm, file={01-cittaviveka-lake}, thumbFile={01-cittaviveka-lake-thumb}, caption={\txt{January Caption}}]{January}
\SetCalendar[bg/.style={opacity=1}]{January}
\SetEvents{January}{\calendarMarks}{\calendarText}

% =============================== February =====================================

\SetPhoto[bleed=3mm, file={February}, thumbFile={02-thailand-wooden-floor-thumb}, caption={\txt{February Caption}}]{February}
\SetCalendar[bg/.style={opacity=1}]{February}
\SetEvents{February}{\calendarMarks}{\calendarText}

% =============================== March ========================================

\SetPhoto[bleed=3mm, file={March}, thumbFile={03-amaravati-brick-wall-thumb}, caption={\txt{March Caption}}]{March}
\SetCalendar[bg/.style={opacity=1}]{March}
\SetEvents{March}{\calendarMarks}{\calendarText}

% =============================== April ========================================

\SetPhoto[bleed=3mm, file={04-thailand-river}, thumbFile={04-thailand-river-thumb}, caption={\txt{April Caption}}, yOffset=-130mm]{April}
\SetCalendar[bg/.style={opacity=1}]{April}
\SetEvents{April}{\calendarMarks}{\calendarText}

% =============================== May ==========================================

\SetPhoto[bleed=3mm, file={05-italy-wooden-rafters}, thumbFile={05-italy-wooden-rafters-thumb}, caption={\txt{May Caption}}, yOffset=-130mm]{May}
\SetCalendar[bg/.style={opacity=1}]{May}
\SetEvents{May}{\calendarMarks}{\calendarText}

% =============================== June =========================================

\SetPhoto[bleed=3mm, file={06-thailand-night}, thumbFile={06-thailand-night-thumb}, caption={\txt{June Caption}}, yOffset=-130mm]{June}
\SetCalendar[bg/.style={opacity=1}]{June}
\SetEvents{June}{\calendarMarks}{\calendarText}

% =============================== July =========================================

\SetPhoto[bleed=3mm, file={07-amaravati-curtain}, thumbFile={07-amaravati-curtain-thumb}, caption={\txt{July Caption}}, yOffset=-130mm]{July}
\SetCalendar[bg/.style={opacity=1}]{July}
\SetEvents{July}{\calendarMarks}{\calendarText}

% =============================== August =======================================

\SetPhoto[bleed=3mm, file={08-harnham-road}, thumbFile={08-harnham-road-thumb}, caption={\txt{August Caption}}, yOffset=-130mm]{August}
\SetCalendar[bg/.style={opacity=1}]{August}
\SetEvents{August}{\calendarMarks}{\calendarText}

% =============================== September ====================================

\SetPhoto[bleed=3mm, file={September}, thumbFile={09-birken-glossy-floor-thumb}, caption={\txt{September Caption}}, yOffset=-130mm]{September}
\SetCalendar[bg/.style={opacity=1}]{September}
\SetEvents{September}{\calendarMarks}{\calendarText}

% =============================== October ======================================

\SetPhoto[bleed=3mm, file={10-sewing}, thumbFile={10-sewing-thumb}, caption={\txt{October Caption}}, yOffset=-130mm]{October}
\SetCalendar[bg/.style={opacity=1}]{October}
\SetEvents{October}{\calendarMarks}{\calendarText}

% =============================== November =====================================

\SetPhoto[bleed=3mm, file={11-amaravati-light-beam}, thumbFile={11-amaravati-light-beam-thumb}, caption={\txt{November Caption}}, yOffset=-130mm]{November}
\SetCalendar[bg/.style={opacity=1}]{November}
\SetEvents{November}{\calendarMarks}{\calendarText}

% =============================== December =====================================

\SetPhoto[bleed=3mm, file={12-harnham-lake}, thumbFile={12-harnham-lake-thumb}, caption={\txt{December Caption}}, yOffset=-130mm]{December}
\SetCalendar[bg/.style={opacity=1}]{December}
\SetEvents{December}{\calendarMarks}{\calendarText}

